<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Email Agent Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-100">
    <div x-data="dashboardApp()" x-init="init()" class="min-h-screen">
        <!-- Navigation -->
        <nav class="bg-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <i class="fas fa-envelope-open-text text-blue-600 text-2xl mr-3"></i>
                        <span class="font-bold text-xl">E-Commerce Email Agent</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button @click="toggleAgent()" 
                                :class="agentStatus === 'running' ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'"
                                class="text-white px-4 py-2 rounded-lg transition">
                            <i class="fas" :class="agentStatus === 'running' ? 'fa-stop' : 'fa-play'"></i>
                            <span x-text="agentStatus === 'running' ? 'Agent Stoppen' : 'Agent Starten'" class="ml-2"></span>
                        </button>
                        <div class="relative">
                            <span class="text-sm text-gray-600">Status:</span>
                            <span class="ml-2 px-2 py-1 rounded text-sm" 
                                  :class="agentStatus === 'running' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'">
                                <i class="fas fa-circle text-xs" :class="agentStatus === 'running' ? 'text-green-500' : 'text-gray-500'"></i>
                                <span x-text="agentStatus === 'running' ? 'Aktiv' : 'Inaktiv'"></span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="max-w-7xl mx-auto py-6 px-4">
            <!-- Stats Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="bg-blue-100 rounded-full p-3">
                            <i class="fas fa-envelope text-blue-600"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Ungelesene Emails</p>
                            <p class="text-2xl font-bold" x-text="stats.unreadEmails || 0"></p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="bg-green-100 rounded-full p-3">
                            <i class="fas fa-check-circle text-green-600"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Bearbeitet (24h)</p>
                            <p class="text-2xl font-bold" x-text="stats.processed24h || 0"></p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="bg-yellow-100 rounded-full p-3">
                            <i class="fas fa-undo text-yellow-600"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Aktive Retouren</p>
                            <p class="text-2xl font-bold" x-text="stats.activeReturns || 0"></p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="bg-purple-100 rounded-full p-3">
                            <i class="fas fa-percentage text-purple-600"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Automatisierung</p>
                            <p class="text-2xl font-bold"><span x-text="stats.automationRate || 0"></span>%</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="bg-white rounded-lg shadow mb-6">
                <div class="border-b">
                    <nav class="flex -mb-px">
                        <button @click="activeTab = 'emails'" 
                                :class="activeTab === 'emails' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                class="py-4 px-6 border-b-2 font-medium text-sm">
                            <i class="fas fa-inbox mr-2"></i>Emails
                        </button>
                        <button @click="activeTab = 'customers'" 
                                :class="activeTab === 'customers' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                class="py-4 px-6 border-b-2 font-medium text-sm">
                            <i class="fas fa-users mr-2"></i>Kunden
                        </button>
                        <button @click="activeTab = 'returns'" 
                                :class="activeTab === 'returns' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                class="py-4 px-6 border-b-2 font-medium text-sm">
                            <i class="fas fa-box-open mr-2"></i>Retouren
                        </button>
                        <button @click="activeTab = 'analytics'" 
                                :class="activeTab === 'analytics' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                class="py-4 px-6 border-b-2 font-medium text-sm">
                            <i class="fas fa-chart-line mr-2"></i>Analytics
                        </button>
                        <button @click="activeTab = 'templates'" 
                                :class="activeTab === 'templates' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                class="py-4 px-6 border-b-2 font-medium text-sm">
                            <i class="fas fa-file-alt mr-2"></i>Templates
                        </button>
                    </nav>
                </div>

                <!-- Tab Content -->
                <div class="p-6">
                    <!-- Emails Tab -->
                    <div x-show="activeTab === 'emails'" x-cloak>
                        <div class="mb-4 flex justify-between items-center">
                            <div class="flex space-x-4">
                                <select x-model="emailFilter.status" @change="loadEmails()" 
                                        class="px-4 py-2 border rounded-lg">
                                    <option value="">Alle Status</option>
                                    <option value="unread">Ungelesen</option>
                                    <option value="read">Gelesen</option>
                                    <option value="responded">Beantwortet</option>
                                    <option value="escalated">Eskaliert</option>
                                </select>
                                <select x-model="emailFilter.category" @change="loadEmails()"
                                        class="px-4 py-2 border rounded-lg">
                                    <option value="">Alle Kategorien</option>
                                    <option value="order_inquiry">Bestellanfragen</option>
                                    <option value="return_request">Retouren</option>
                                    <option value="complaint">Beschwerden</option>
                                    <option value="shipping_issue">Versandprobleme</option>
                                </select>
                            </div>
                            <button @click="processEmails()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                                <i class="fas fa-sync mr-2"></i>Emails abrufen
                            </button>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        <th class="px-6 py-3">Status</th>
                                        <th class="px-6 py-3">Von</th>
                                        <th class="px-6 py-3">Betreff</th>
                                        <th class="px-6 py-3">Kategorie</th>
                                        <th class="px-6 py-3">Priorit√§t</th>
                                        <th class="px-6 py-3">Datum</th>
                                        <th class="px-6 py-3">Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <template x-for="email in emails" :key="email.id">
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 py-1 text-xs rounded-full"
                                                      :class="{
                                                          'bg-yellow-100 text-yellow-800': email.status === 'unread',
                                                          'bg-gray-100 text-gray-800': email.status === 'read',
                                                          'bg-green-100 text-green-800': email.status === 'responded',
                                                          'bg-red-100 text-red-800': email.status === 'escalated'
                                                      }"
                                                      x-text="translateStatus(email.status)">
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap" x-text="email.from_email"></td>
                                            <td class="px-6 py-4" x-text="email.subject"></td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="text-sm" x-text="translateCategory(email.category)"></span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 py-1 text-xs rounded-full"
                                                      :class="{
                                                          'bg-red-100 text-red-800': email.priority === 'urgent',
                                                          'bg-yellow-100 text-yellow-800': email.priority === 'high',
                                                          'bg-blue-100 text-blue-800': email.priority === 'normal',
                                                          'bg-gray-100 text-gray-800': email.priority === 'low'
                                                      }"
                                                      x-text="email.priority">
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="formatDate(email.date)"></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                <button @click="viewEmail(email)" class="text-blue-600 hover:text-blue-900 mr-2">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button @click="replyToEmail(email)" class="text-green-600 hover:text-green-900">
                                                    <i class="fas fa-reply"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Customers Tab -->
                    <div x-show="activeTab === 'customers'" x-cloak>
                        <div class="mb-4">
                            <input type="text" x-model="customerSearch" @input="searchCustomers()"
                                   placeholder="Kunde suchen..." 
                                   class="w-full px-4 py-2 border rounded-lg">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <template x-for="customer in customers" :key="customer.id">
                                <div class="bg-gray-50 rounded-lg p-4 hover:shadow-md transition">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <h3 class="font-semibold" x-text="customer.name"></h3>
                                            <p class="text-sm text-gray-600" x-text="customer.email"></p>
                                        </div>
                                        <span class="px-2 py-1 text-xs rounded-full"
                                              :class="{
                                                  'bg-purple-100 text-purple-800': customer.loyalty_tier === 'vip',
                                                  'bg-yellow-100 text-yellow-800': customer.loyalty_tier === 'gold',
                                                  'bg-gray-100 text-gray-800': customer.loyalty_tier === 'standard'
                                              }"
                                              x-text="customer.loyalty_tier?.toUpperCase()">
                                        </span>
                                    </div>
                                    <div class="text-sm space-y-1">
                                        <p><span class="text-gray-600">Lifetime Value:</span> 
                                           <span class="font-semibold" x-text="formatCurrency(customer.lifetime_value)"></span>
                                        </p>
                                        <p><span class="text-gray-600">Retourenquote:</span> 
                                           <span x-text="(customer.return_rate * 100).toFixed(0) + '%'"></span>
                                        </p>
                                    </div>
                                    <button @click="viewCustomer(customer)" 
                                            class="mt-3 text-blue-600 hover:text-blue-800 text-sm">
                                        Details anzeigen ‚Üí
                                    </button>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Returns Tab -->
                    <div x-show="activeTab === 'returns'" x-cloak>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        <th class="px-6 py-3">Retouren-Nr.</th>
                                        <th class="px-6 py-3">Kunde</th>
                                        <th class="px-6 py-3">Bestell-Nr.</th>
                                        <th class="px-6 py-3">Status</th>
                                        <th class="px-6 py-3">Grund</th>
                                        <th class="px-6 py-3">Erstattung</th>
                                        <th class="px-6 py-3">Erstellt</th>
                                        <th class="px-6 py-3">Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <template x-for="return in returns" :key="return.id">
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap font-medium" x-text="return.return_number"></td>
                                            <td class="px-6 py-4 whitespace-nowrap" x-text="return.name"></td>
                                            <td class="px-6 py-4 whitespace-nowrap" x-text="return.order_number"></td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 py-1 text-xs rounded-full"
                                                      :class="getReturnStatusClass(return.status)"
                                                      x-text="translateReturnStatus(return.status)">
                                                </span>
                                            </td>
                                            <td class="px-6 py-4" x-text="return.reason_category"></td>
                                            <td class="px-6 py-4 whitespace-nowrap" x-text="formatCurrency(return.refund_amount)"></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="formatDate(return.created_at)"></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                                <button @click="processReturn(return)" class="text-blue-600 hover:text-blue-900">
                                                    <i class="fas fa-cog"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Analytics Tab -->
                    <div x-show="activeTab === 'analytics'" x-cloak>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white p-4 rounded-lg">
                                <h3 class="text-lg font-semibold mb-4">Email-Kategorien</h3>
                                <canvas id="categoryChart"></canvas>
                            </div>
                            <div class="bg-white p-4 rounded-lg">
                                <h3 class="text-lg font-semibold mb-4">Bearbeitungszeit</h3>
                                <canvas id="responseTimeChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="mt-6 bg-white p-4 rounded-lg">
                            <h3 class="text-lg font-semibold mb-4">Retouren-Gr√ºnde</h3>
                            <canvas id="returnReasonsChart"></canvas>
                        </div>
                    </div>

                    <!-- Templates Tab -->
                    <div x-show="activeTab === 'templates'" x-cloak>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <template x-for="template in templates" :key="template.id">
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <h3 class="font-semibold mb-2" x-text="template.name"></h3>
                                    <p class="text-sm text-gray-600 mb-2" x-text="template.subject"></p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"
                                              x-text="translateCategory(template.category)"></span>
                                        <button @click="editTemplate(template)" class="text-blue-600 hover:text-blue-800 text-sm">
                                            Bearbeiten
                                        </button>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Modal -->
        <div x-show="showEmailModal" x-cloak
             class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-y-auto m-4">
                <div class="p-6">
                    <div class="flex justify-between items-start mb-4">
                        <h2 class="text-xl font-semibold" x-text="selectedEmail?.subject"></h2>
                        <button @click="showEmailModal = false" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4 space-y-2">
                        <p><span class="font-semibold">Von:</span> <span x-text="selectedEmail?.from_email"></span></p>
                        <p><span class="font-semibold">Datum:</span> <span x-text="formatDate(selectedEmail?.date)"></span></p>
                        <p><span class="font-semibold">Kategorie:</span> <span x-text="translateCategory(selectedEmail?.category)"></span></p>
                        <p><span class="font-semibold">Priorit√§t:</span> <span x-text="selectedEmail?.priority"></span></p>
                    </div>
                    
                    <div class="border-t pt-4">
                        <div class="whitespace-pre-wrap" x-text="selectedEmail?.body"></div>
                    </div>
                    
                    <div class="mt-6 flex space-x-4">
                        <button @click="replyToEmail(selectedEmail)" 
                                class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                            <i class="fas fa-reply mr-2"></i>Antworten
                        </button>
                        <button @click="escalateEmail(selectedEmail)" 
                                class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                            <i class="fas fa-exclamation-triangle mr-2"></i>Eskalieren
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function dashboardApp() {
            return {
                agentStatus: 'stopped',
                activeTab: 'emails',
                stats: {},
                emails: [],
                customers: [],
                returns: [],
                templates: [],
                emailFilter: { status: '', category: '' },
                customerSearch: '',
                showEmailModal: false,
                selectedEmail: null,
                charts: {},
                
                async init() {
                    await this.checkAgentStatus();
                    await this.loadStats();
                    await this.loadEmails();
                    await this.loadCustomers();
                    await this.loadReturns();
                    await this.loadTemplates();
                    this.initCharts();
                    
                    // Auto-refresh every 30 seconds
                    setInterval(() => {
                        this.loadStats();
                        if (this.activeTab === 'emails') this.loadEmails();
                    }, 30000);
                },
                
                async checkAgentStatus() {
                    try {
                        const response = await axios.get('/api/health');
                        this.agentStatus = response.data.agent;
                    } catch (error) {
                        console.error('Error checking agent status:', error);
                    }
                },
                
                async toggleAgent() {
                    try {
                        if (this.agentStatus === 'running') {
                            await axios.post('/api/agent/stop');
                            this.agentStatus = 'stopped';
                        } else {
                            await axios.post('/api/agent/start', { interval: 60000 });
                            this.agentStatus = 'running';
                        }
                    } catch (error) {
                        console.error('Error toggling agent:', error);
                    }
                },
                
                async loadStats() {
                    try {
                        const response = await axios.get('/api/analytics/overview');
                        this.stats = {
                            unreadEmails: response.data.emailStats?.total || 0,
                            processed24h: response.data.emailStats?.resolved || 0,
                            activeReturns: response.data.returnStats?.total_returns || 0,
                            automationRate: response.data.automationRate?.rate || 0
                        };
                    } catch (error) {
                        console.error('Error loading stats:', error);
                    }
                },
                
                async loadEmails() {
                    try {
                        const params = new URLSearchParams();
                        if (this.emailFilter.status) params.append('status', this.emailFilter.status);
                        if (this.emailFilter.category) params.append('category', this.emailFilter.category);
                        
                        const response = await axios.get(`/api/emails?${params}`);
                        this.emails = response.data.emails;
                    } catch (error) {
                        console.error('Error loading emails:', error);
                    }
                },
                
                async loadCustomers() {
                    try {
                        const response = await axios.get('/api/customers');
                        this.customers = response.data;
                    } catch (error) {
                        console.error('Error loading customers:', error);
                    }
                },
                
                async loadReturns() {
                    try {
                        const response = await axios.get('/api/returns');
                        this.returns = response.data;
                    } catch (error) {
                        console.error('Error loading returns:', error);
                    }
                },
                
                async loadTemplates() {
                    try {
                        const response = await axios.get('/api/templates');
                        this.templates = response.data;
                    } catch (error) {
                        console.error('Error loading templates:', error);
                    }
                },
                
                async processEmails() {
                    try {
                        await axios.post('/api/agent/process');
                        await this.loadEmails();
                        await this.loadStats();
                    } catch (error) {
                        console.error('Error processing emails:', error);
                    }
                },
                
                async searchCustomers() {
                    if (this.customerSearch.length < 2) {
                        await this.loadCustomers();
                        return;
                    }
                    
                    try {
                        const response = await axios.get(`/api/customers/search?search=${this.customerSearch}`);
                        this.customers = response.data;
                    } catch (error) {
                        console.error('Error searching customers:', error);
                    }
                },
                
                viewEmail(email) {
                    this.selectedEmail = email;
                    this.showEmailModal = true;
                },
                
                async replyToEmail(email) {
                    const reply = prompt('Antwort eingeben:');
                    if (reply) {
                        try {
                            await axios.post(`/api/emails/${email.id}/reply`, {
                                subject: `Re: ${email.subject}`,
                                body: reply
                            });
                            alert('Antwort gesendet!');
                            await this.loadEmails();
                        } catch (error) {
                            console.error('Error replying to email:', error);
                        }
                    }
                },
                
                async escalateEmail(email) {
                    const reason = prompt('Grund f√ºr Eskalation:');
                    if (reason) {
                        try {
                            await axios.post(`/api/emails/${email.id}/escalate`, { reason });
                            alert('Email wurde eskaliert!');
                            await this.loadEmails();
                        } catch (error) {
                            console.error('Error escalating email:', error);
                        }
                    }
                },
                
                viewCustomer(customer) {
                    window.location.href = `/customer/${customer.id}`;
                },
                
                async processReturn(return) {
                    const action = confirm('Retoure genehmigen?') ? 'approve' : 'reject';
                    try {
                        await axios.post(`/api/returns/${return.id}/process`, { action });
                        await this.loadReturns();
                    } catch (error) {
                        console.error('Error processing return:', error);
                    }
                },
                
                editTemplate(template) {
                    window.location.href = `/templates/${template.id}/edit`;
                },
                
                initCharts() {
                    // Category Chart
                    const categoryCtx = document.getElementById('categoryChart')?.getContext('2d');
                    if (categoryCtx) {
                        this.charts.category = new Chart(categoryCtx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Bestellungen', 'Retouren', 'Beschwerden', 'Sonstige'],
                                datasets: [{
                                    data: [45, 25, 15, 15],
                                    backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#6B7280']
                                }]
                            }
                        });
                    }
                    
                    // Response Time Chart
                    const responseCtx = document.getElementById('responseTimeChart')?.getContext('2d');
                    if (responseCtx) {
                        this.charts.responseTime = new Chart(responseCtx, {
                            type: 'line',
                            data: {
                                labels: ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'],
                                datasets: [{
                                    label: 'Antwortzeit (Minuten)',
                                    data: [15, 12, 18, 14, 16, 25, 30],
                                    borderColor: '#3B82F6',
                                    tension: 0.4
                                }]
                            }
                        });
                    }
                    
                    // Return Reasons Chart
                    const returnCtx = document.getElementById('returnReasonsChart')?.getContext('2d');
                    if (returnCtx) {
                        this.charts.returnReasons = new Chart(returnCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Defekt', 'Falsche Gr√∂√üe', 'Gef√§llt nicht', 'Falsche Ware', 'Besch√§digt'],
                                datasets: [{
                                    label: 'Anzahl Retouren',
                                    data: [23, 19, 15, 12, 8],
                                    backgroundColor: '#3B82F6'
                                }]
                            }
                        });
                    }
                },
                
                // Helper functions
                formatDate(date) {
                    if (!date) return '';
                    return new Date(date).toLocaleString('de-DE');
                },
                
                formatCurrency(amount) {
                    return new Intl.NumberFormat('de-DE', {
                        style: 'currency',
                        currency: 'EUR'
                    }).format(amount || 0);
                },
                
                translateStatus(status) {
                    const translations = {
                        'unread': 'Ungelesen',
                        'read': 'Gelesen',
                        'responded': 'Beantwortet',
                        'escalated': 'Eskaliert',
                        'resolved': 'Gel√∂st'
                    };
                    return translations[status] || status;
                },
                
                translateCategory(category) {
                    const translations = {
                        'order_inquiry': 'Bestellanfrage',
                        'return_request': 'Retoure',
                        'complaint': 'Beschwerde',
                        'shipping_issue': 'Versandproblem',
                        'payment_issue': 'Zahlungsproblem',
                        'product_question': 'Produktfrage',
                        'general_inquiry': 'Allgemeine Anfrage'
                    };
                    return translations[category] || category;
                },
                
                translateReturnStatus(status) {
                    const translations = {
                        'requested': 'Angefragt',
                        'approved': 'Genehmigt',
                        'received': 'Erhalten',
                        'inspecting': 'In Pr√ºfung',
                        'processed': 'Bearbeitet',
                        'refunded': 'Erstattet',
                        'rejected': 'Abgelehnt'
                    };
                    return translations[status] || status;
                },
                
                getReturnStatusClass(status) {
                    const classes = {
                        'requested': 'bg-yellow-100 text-yellow-800',
                        'approved': 'bg-blue-100 text-blue-800',
                        'received': 'bg-purple-100 text-purple-800',
                        'inspecting': 'bg-orange-100 text-orange-800',
                        'processed': 'bg-green-100 text-green-800',
                        'refunded': 'bg-green-100 text-green-800',
                        'rejected': 'bg-red-100 text-red-800'
                    };
                    return classes[status] || 'bg-gray-100 text-gray-800';
                }
            }
        }
    </script>
</body>
</html>